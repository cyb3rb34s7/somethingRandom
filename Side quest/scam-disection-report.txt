================================================================================
                    MALWARE ANALYSIS REPORT
                    IGL CONNECT GAS.apk
              COMPLETE REVERSE ENGINEERING ANALYSIS
================================================================================
Date: 2024-12-20
Analyst: Automated Analysis (jadx + androguard + manual analysis)

================================================================================
EXECUTIVE SUMMARY
================================================================================
This APK is a BANKING TROJAN / REMOTE ACCESS TROJAN (RAT) disguised as an
"IGL Connect Gas" application. It impersonates Indraprastha Gas Limited (IGL)
to trick victims into installing malware under the pretext of updating their
gas connection.

THREAT LEVEL: CRITICAL
TYPE: Banking Trojan / RAT with Accessibility Abuse

================================================================================
FILE IDENTIFICATION
================================================================================
Filename:   IGL CONNECT GAS.apk
Size:       19,796,642 bytes (19.8 MB)
MD5:        b6c42da0d534aea84309045a14004e3f
SHA1:       29b690277d87a2f0abaa5d674c4f04e31452c4e8
SHA256:     f6539cd867703d32b1b4ea0a81cc7ba97bb38c2fdb24b606ad7e5cb76db43f86

PACKAGE DETAILS (from AndroidManifest.xml):
Real Package Name:  com.tdqs.brrnnlanhgeh
Version Code:       12120
Version Name:       12.12.0-5.12.10
Target SDK:         28 (Android 9)
Min SDK:            26 (Android 8)

================================================================================
TROJANIZED APP ARCHITECTURE
================================================================================
This malware is built by TROJANIZING a legitimate open-source app:

LEGITIMATE APP (Cover):
- Name: Auto Auto-Rotate
- Author: Juan Garc√≠a Basilio (juanitobananas)
- Source: https://gitlab.com/juanitobananas/auto-auto-rotate
- Purpose: Automatically rotates screen based on app settings

MALWARE LOADER:
- Package: plmtzb
- Classes: c0mzt1 (Application), cpsmwg (Activity)
- Native Library: liblqlgelbnp.so (443KB ARM64 / 248KB ARMv7)
- ALL main methods are NATIVE (hidden in .so file)

HIDDEN PAYLOAD:
- Package: com.tdqs.brrnnlanhgeh (NOT in DEX - loaded dynamically!)
- Services: eyNXVtXvQjazEnYk, elYEPxKsRKtCea
- Receivers: eKJqHfnEoHLixSB, eZSjsSJafYRe
- Loaded from ENCRYPTED ASSETS at runtime

ENCRYPTED PAYLOAD FILES (in assets/):
- CiNHl          6.2 MB (encrypted DEX/payload)
- lvpEHKwLR      4.0 MB (encrypted DEX/payload)
- LVcTTVzosS     2.6 MB (encrypted DEX/payload)
- BAFqEzZeW      885 KB (encrypted config)
- RDcQA          758 KB (encrypted data)
- + 5 smaller encrypted files

C2 (Command & Control):
- Uses Firebase Cloud Messaging for C2 communication
- FirebaseMessagingService registered in manifest
- No hardcoded URLs (configuration loaded from encrypted assets)

================================================================================
MALWARE CAPABILITIES (CONFIRMED)
================================================================================

1. SMS INTERCEPTION
   - Can intercept incoming SMS messages
   - Steals OTP (One-Time Passwords) for banking transactions
   - Uses: SmsManager, getDefault

2. ACCESSIBILITY SERVICE ABUSE
   - Requests Accessibility Service permissions
   - Can perform actions on behalf of user (tap, type, navigate)
   - Can read screen content of other apps
   - Uses: AccessibilityService, AccessibilityEvent, AccessibilityNodeInfo, performAction

3. SCREEN RECORDING
   - Can capture/record device screen
   - Uses: MediaProjection API

4. KEYLOGGING
   - Can capture keystrokes
   - Uses: KeyEvent, onKey handlers

5. OVERLAY ATTACKS (Phishing)
   - Can display fake screens over legitimate banking apps
   - Steals login credentials and PINs
   - Uses: WindowManager, addView, LayoutParams

6. CONTACT THEFT
   - Steals contact list
   - Uses: ContentResolver, CONTENT_URI, query

7. LOCATION TRACKING
   - Tracks victim's GPS location
   - Uses: LocationManager, getLastKnownLocation

8. DEVICE INFORMATION THEFT
   - Steals IMEI, Device ID, SIM info
   - Uses: TelephonyManager, getDeviceId

9. DYNAMIC CODE LOADING
   - Downloads and executes additional malware code
   - Encrypted payloads in assets folder (14+ MB of encrypted data)
   - Uses: DexClassLoader, loadClass

10. CALL LOG ACCESS
    - Can read call history

================================================================================
OBFUSCATION TECHNIQUES
================================================================================
- Heavy code obfuscation (R8/ProGuard)
- All package names shortened to single letters (a, b, c, a0, b0, etc.)
- Main malware package: "plmtzb" (obfuscated)
- Native library with obfuscated name: "liblqlgelbnp.so"
- 14+ MB of encrypted payload data in assets folder
- Custom compression on AndroidManifest.xml and resources.arsc

================================================================================
TARGETED SERVICES (INDIA-SPECIFIC)
================================================================================
- UPI (Unified Payments Interface)
- SBI (State Bank of India)
- Axis Bank
- Other Indian banking applications

================================================================================
TECHNICAL INDICATORS (IOCs)
================================================================================
Package Name (Obfuscated): plmtzb
Main Classes:
  - plmtzb.c0mzt1 (hooks attachBaseContext - app initialization)
  - plmtzb.cpsmwg (main activity with onCreate)

Native Library:
  - liblqlgelbnp.so (ARM64 and ARMv7)

Encrypted Assets:
  - CiNHl (6.2 MB)
  - lvpEHKwLR (4.0 MB)
  - LVcTTVzosS (2.6 MB)
  - BAFqEzZeW (885 KB)
  - RDcQA (758 KB)
  + several smaller encrypted files

================================================================================
ATTACK VECTOR
================================================================================
1. Victim receives phone call from scammer posing as gas company executive
2. Scammer creates urgency: "Your gas will be cut off if you don't update"
3. Victim is instructed to download and install APK
4. Malware requests Accessibility Service permissions
5. Once granted, malware can:
   - Control the device
   - Intercept SMS/OTPs
   - Display fake banking screens
   - Steal credentials
   - Make unauthorized transactions

================================================================================
REPORTING - WHERE TO REPORT THIS MALWARE
================================================================================

INDIA:
1. National Cyber Crime Reporting Portal
   Website: https://cybercrime.gov.in
   Helpline: 1930
   - File complaint online with APK hashes

2. Indian Computer Emergency Response Team (CERT-In)
   Email: incident@cert-in.org.in
   Website: https://www.cert-in.org.in
   - Send malware sample and this report

3. Reserve Bank of India (RBI)
   - Report via bank's fraud reporting mechanism
   - RBI has ombudsman for digital payment frauds

4. Local Police Cyber Cell
   - File FIR with evidence

5. IGL (Indraprastha Gas Limited)
   - Notify them their brand is being impersonated
   - Website: https://www.iglonline.net
   - Customer Care: 1800-2100-2000

INTERNATIONAL:
6. VirusTotal
   - Upload APK for community detection
   - https://www.virustotal.com

7. Google Safe Browsing
   - Report phishing: https://safebrowsing.google.com/safebrowsing/report_phish/

8. Android Security Team
   - Report via: security@android.com

================================================================================
EVIDENCE TO PRESERVE
================================================================================
1. This APK file (IGL CONNECT GAS.apk)
2. Phone call records from scammer (if available)
3. Phone number of scammer
4. WhatsApp/message history with scammer
5. This analysis report

================================================================================
DISCLAIMER
================================================================================
This analysis was performed for defensive security purposes on malware that
was sent to the victim. The APK was not installed on any device.

================================================================================

================================================================================
ENCRYPTION BREAKTHROUGH - ADVANCED ANALYSIS
================================================================================
Analysis Date: December 21, 2025
Analyst: Automated Analysis (radare2 + Python + Ghidra)

ENCRYPTION ALGORITHM CRACKED:
- Type: XOR cipher with 8-byte repeating key
- XOR Key: 07 26 0c 6f 0f f2 8e 73
- Key derived by comparing encrypted header to expected DEX magic bytes

DECRYPTION RESULTS:
- CiNHl (6.2 MB): Successfully decrypted to Dalvik DEX file (version 035)
- Other assets use different/derived keys (secondary encryption layer)

NATIVE LIBRARY ANALYSIS (liblqlgelbnp.so):
- 549 functions identified
- 9 JNI entry points exported
- Main functions:
  * Java_plmtzb_c0mzt1_attachBaseContext: 31,780 bytes (initialization)
  * Java_plmtzb_cpsmwg_onCreate: 17,532 bytes (activity setup)
  * Java_plmtzb_cpsmwg_run: 50,952 bytes (main malware logic)
- String decryption performed via inline XOR at runtime
- No hardcoded C2 URLs found (loaded from encrypted payload)

C2 MECHANISM:
- Firebase Cloud Messaging (FCM) used for command & control
- FirebaseMessagingService registered in manifest
- FCM provides:
  * Push notifications for C2 commands
  * Bidirectional communication channel
  * Difficult to block (uses Google infrastructure)

OEM SECURITY BYPASS:
Manifest queries these security apps to bypass them:
  * com.miui.securitycenter (Xiaomi)
  * com.huawei.systemmanager (Huawei)
  * com.coloros.safecenter (OPPO)
  * com.vivo.permissionmanager (Vivo)
  * com.samsung.android (Samsung)

NEXT STEPS FOR COMPLETE C2 EXTRACTION:
1. Dynamic analysis with Android emulator + mitmproxy
2. Frida hooks to capture runtime decryption
3. Firebase project ID can be extracted when app runs

================================================================================

================================================================================
KALI LINUX DEEP ANALYSIS RESULTS
================================================================================
Analysis Date: Sat, Dec 20, 2025 11:58:57 PM
Analyst System: Kali Linux

DECOMPILATION RESULTS:
- jadx successfully decompiled classes.dex
- 1388 classes analyzed
- Main malware loader: plmtzb package
- Real malware: com.tdqs.brrnnlanhgeh (dynamically loaded)

NATIVE LIBRARY ANALYSIS (liblqlgelbnp.so):
- Size: 443,504 bytes (ARM64)
- JNI Entry Points:
  * Java_plmtzb_c0mzt1_attachBaseContext (47KB function!)
  * Java_plmtzb_cpsmwg_onCreate (25KB function)
  * Java_plmtzb_cpsmwg_run (85KB function!)
- No hardcoded URLs/IPs found
- Encryption handled in native code

ENCRYPTED ASSETS:
- CiNHl: 6.2 MB (likely main DEX payload)
- lvpEHKwLR: 4.0 MB
- LVcTTVzosS: 2.6 MB
- BAFqEzZeW: 885 KB
- Total: 14+ MB of encrypted malware

ANDROID MANIFEST FINDINGS:
- Queries OEM security apps (to bypass them):
  * com.miui.securitycenter (Xiaomi)
  * com.huawei.systemmanager (Huawei)
  * com.coloros.safecenter (OPPO)
  * com.vivo.permissionmanager (Vivo)
  * com.samsung.android (Samsung)

MALWARE COMPONENTS (loaded dynamically):
- com.tdqs.brrnnlanhgeh.MainActivity
- com.tdqs.brrnnlanhgeh.emUBQAoZWxhSHX (obfuscated activity)
- com.tdqs.brrnnlanhgeh.eyNXVtXvQjazEnYk (Firebase C2 service!)
- com.tdqs.brrnnlanhgeh.elYEPxKsRKtCea (background service)
- com.tdqs.brrnnlanhgeh.eKJqHfnEoHLixSB (boot receiver)
- com.tdqs.brrnnlanhgeh.eZSjsSJafYRe (boot completed receiver)

CONCLUSION:
This is a PROFESSIONAL banking trojan operated by organized criminals.
The multi-layer encryption prevents static extraction of C2 servers.
Dynamic analysis (running in emulator with network capture) required
to obtain actual C2 infrastructure.

TOOLS USED:
- jadx (decompilation)
- apktool (resource decoding - failed due to encrypted ZIP)
- objdump, nm, strings (binary analysis)
- radare2 (native library analysis)
- Python (encryption analysis attempts)

================================================================================
